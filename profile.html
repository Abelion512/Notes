<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Profile â€“ Abelion Notes</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <style>
    :root {
      --blue-gradient: linear-gradient(135deg,#5ecbff 0%,#4b7cf3 100%);
      --blue-gradient-rev: linear-gradient(135deg,#4b7cf3 0%,#5ecbff 100%);
      --bg-main: #152235;
      --bg-card: #5b91ea;
      --bg-card-dark: #3b5282;
      --text-main: #fff;
      --text-sub: #bfe4ff;
      --border-radius: 36px;
      --shadow: 0 6px 36px #081c3d33, 0 1.5px 8px #0002;
      --btn-radius: 16px;
      --transition: .18s cubic-bezier(.7,0,.3,1);
      --font-main: 'Inter', Arial, sans-serif;
      --badge-locked: #dde4ee;
    }
    html, body {
      background: var(--bg-main);
      min-height: 100vh;
      font-family: var(--font-main);
      color: var(--text-main);
      padding: 0; margin: 0;
      transition: background var(--transition);
    }
    .container {
      min-height: 100vh; display:flex; align-items:center; justify-content:center;
      padding: 0 0vw;
    }
    .profile-card {
      background: var(--bg-card);
      width: 100%; max-width: 400px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 35px 20px 16px 20px;
      text-align: center;
      margin: 36px 0 22px 0;
      display: flex; flex-direction: column; align-items: center;
      position: relative;
      min-height: 83vh;
      overflow: hidden;
      transition: background var(--transition);
    }
    .profile-nav {
      position: absolute; top: 18px; left: 0; right: 0;
      display: flex; justify-content: space-between; align-items:center; z-index:3;
      padding: 0 18px;
    }
    .nav-btn, .nav-info-btn {
      background: var(--blue-gradient); color: #fff; border: none;
      border-radius: 15px; padding: 7px 18px; font-weight: 600; font-size: .97em;
      cursor: pointer; outline: none; margin:0 2px; box-shadow:0 1.5px 8px #0b3a7f22;
      transition: filter .14s;
    }
    .nav-btn:active, .nav-info-btn:active { filter:brightness(0.92);}
    .profile-avatar-wrap { margin-top: 20px; margin-bottom: 16px; }
    .profile-avatar {
      width: 96px; height: 96px; border-radius: 50%; object-fit: cover;
      border: 3.5px solid #fff;
      box-shadow: 0 2px 14px #1d5bcf33;
      background: #dde8f8;
      cursor: pointer; transition: box-shadow .19s;
      display: block; margin: 0 auto 7px auto;
    }
    .edit-photo-label {
      display:block; color: #2b326b; background: #fff; font-weight:700;
      border-radius: 99px; padding:5px 16px; font-size:.98em; margin:0 auto;
      box-shadow:0 1px 5px #3b528215;
      transition: background .17s, color .13s;
      cursor: pointer; margin-bottom: 8px;
    }
    .edit-photo-label:hover { background: #eaf3ff; color:#236de3;}
    .profile-greeting {
      font-size:1.12em; color:var(--text-main); margin-bottom:15px; font-weight:500;
      margin-top:7px;
    }
    .level-title-row {
      display: flex; justify-content:center; gap:8px; align-items:center; margin-bottom:10px;
    }
    .xp-title-btn, .xp-level-btn {
      background: var(--blue-gradient-rev); color: #fff; border: none;
      border-radius: 16px; padding: 6px 18px; font-weight:600; font-size:1em;
      letter-spacing:.02em; box-shadow:0 1.5px 8px #1d5bcf22; margin:0;
      cursor:pointer; transition:filter .13s;
    }
    .xp-title-btn:active, .xp-level-btn:active { filter:brightness(0.94);}
    .xp-bar-label {
      font-size:.98em; color:var(--text-sub); margin-bottom:3px; margin-top:5px;
    }
    .xp-bar {
      width:100%; max-width:270px; height:16px; border-radius:9px;
      background: #d1eaff; margin:0 auto 3px auto; overflow:hidden; position:relative;
      box-shadow:0 1px 7px #39b2ff22;
    }
    .xp-bar-inner {
      height:100%; background: var(--blue-gradient); border-radius:9px 0 0 9px;
      width:0%; min-width:0; transition: width .7s cubic-bezier(.6,0,.4,1);
      box-shadow: 0 1.5px 7px #4be4ff33;
    }
    .xp-countdown {
      color:var(--text-sub); font-size: .93em; margin-bottom:10px;
      min-height:1em;
    }
    .badge-panel {
      background: var(--blue-gradient);
      padding:15px 6px 13px 6px;
      border-radius: 20px;
      margin: 18px 0 18px 0;
      display: flex; flex-direction: column; align-items:center;
      box-shadow:0 2px 16px #5ecbff18;
      width:100%; max-width:290px;
      transition: background var(--transition);
    }
    .badge-panel-title {
      font-weight:700; margin-bottom:12px; font-size:1.1em; letter-spacing:0.01em;
      text-shadow:0 1px 2px #155;
    }
    .badges-row {
      display: flex; gap:12px; justify-content:center;
      margin-bottom:0px; margin-top:4px;
      width:100%;
    }
    .badge-box {
      width:48px; height:48px; background:var(--badge-locked);
      border-radius: 18px; display:flex; align-items:center; justify-content:center;
      font-size:1.7em; font-weight:700; color:#a9b5c7;
      box-shadow:0 1px 10px #1112;
      cursor: pointer; transition: background .2s, transform .2s, color .2s;
      border:2.5px solid transparent;
      position:relative;
    }
    .badge-box--unlocked {
      background: #fff; color: #4b7cf3; border-color: #5ecbff;
    }
    .badge-box--active {
      border-color: #fffa67;
      box-shadow:0 2px 13px #fffa6740;
      background: #ffe;
      color:#e8b100;
      transform:scale(1.10);
    }
    .badge-label {
      position:absolute; bottom:-25px; left:50%; transform:translateX(-50%);
      background:#213f77; color:#fff; border-radius:8px; font-size:.95em;
      padding:3px 10px; white-space:nowrap; opacity:0; pointer-events:none;
      box-shadow:0 1px 8px #245ff333;
      transition:opacity .13s, bottom .13s;
      z-index:5;
    }
    .badge-box:hover .badge-label { opacity:1; bottom:-31px;}
    .profile-btn-row {
      display:flex; gap:16px; justify-content:center; margin:24px 0 10px 0;
      width:100%; max-width:330px;
    }
    .profile-btn {
      background: var(--blue-gradient); color:#fff; border:none;
      border-radius: var(--btn-radius);
      font-size:1em; font-weight:700;
      padding:10px 0; width:100%; min-width:113px;
      box-shadow:0 1.5px 8px #1d5bcf18;
      cursor:pointer; transition:filter .14s;
    }
    .profile-btn:active { filter:brightness(0.96);}
    .profile-footer {position: absolute; padding-top: 10px; bottom: 12px; left:0; right:0; text-align:center; color:#d4e6fa; font-size:.98em;}
    @media (max-width: 540px){
      .profile-card {
        border-radius: 30px; max-width:97vw; padding:18px 2vw 18px 2vw;
        min-height: 93vh;
      }
      .badge-panel {max-width:98vw;}
      .profile-btn-row{max-width:99vw;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="profile-card" id="profile-card">
      <div class="profile-nav">
        <button class="nav-btn" onclick="window.history.back()">&lt; Back</button>
        <button class="nav-info-btn" onclick="alert('Version info coming soon!')">Version info</button>
      </div>
      <div class="profile-avatar-wrap">
        <img src="https://ui-avatars.com/api/?name=User&background=5ecbff&color=222&size=128" 
             alt="Foto Profil" class="profile-avatar" id="profile-avatar"/>
        <input type="file" accept="image/*" id="profile-photo-input" style="display:none"/>
        <label for="profile-photo-input" class="edit-photo-label">Edit photo</label>
      </div>
      <div class="profile-greeting" id="profile-greeting">
        Selamat datang, <b id="profile-username">User</b> ðŸ‘‹
      </div>

      <div class="level-title-row">
        <button class="xp-title-btn" id="xp-title-btn">âœ¨ Title</button>
        <button class="xp-level-btn" id="xp-level-btn">level 1</button>
      </div>
      <div class="xp-bar-label">XP Progress</div>
      <div class="xp-bar">
        <div class="xp-bar-inner" id="xp-bar-inner" style="width:0%"></div>
      </div>
      <div class="xp-countdown" id="xp-countdown">10 XP untuk naik level</div>

      <div class="badge-panel">
        <div class="badge-panel-title">Badge/Rank</div>
        <div class="badges-row" id="badges-row"></div>
        <button class="profile-btn" style="margin-top:18px;" id="change-title-btn">Ganti Title</button>
      </div>

      <div class="profile-btn-row">
        <button class="profile-btn" onclick="editProfile()">Edit Profile</button>
        <button class="profile-btn" onclick="openSettings()">Settings</button>
      </div>
      <div class="profile-footer">
        Â© 2025 Abelion Notes. All rights reserved.
      </div>
    </div>
  </div>
  <script>
    // DATA TITLE / RANK
    const TITLES = [
      { rank: 1, key:"newbie", icon:"ðŸªœ", name:"Newbie", cond: p=>!!p },
      { rank: 2, key:"explorer", icon:"ðŸŒ¿", name:"Explorer", cond: p=>(p.days||0)>=3 },
      { rank: 3, key:"intermediate", icon:"ðŸ”§", name:"Intermediate", cond: p=>(p.days||0)>=7 && (p.notes||0)>=10 },
      { rank: 4, key:"prodigy", icon:"ðŸ”¥", name:"Prodigy", cond: p=>(p.level||0)>=15 },
      { rank: 5, key:"master", icon:"ðŸ’Ž", name:"Master", cond: p=>(p.days||0)>=30 && p.usedAll },
      { rank: 6, key:"grandmaster", icon:"ðŸ‘‘", name:"Grandmaster", cond: p=>(p.level||0)>=40||(p.weekly||0)>90 }
    ];
    // XP LEVEL SYSTEM
    function getLevelXP(level) {
      if(level<=5) return 10;
      if(level<=10) return 15;
      if(level<=15) return 20;
      return 25;
    }
    // Dummy user data for demo
    let user = {
      username: "Abelion",
      photo: "",
      xp: 17,
      level: 3,
      days: 8,
      notes: 13,
      usedAll: false,
      weekly: 60,
      title: "intermediate" // key
    };
    // load user from localStorage
    function loadUser() {
      try {
        return JSON.parse(localStorage.getItem('abelion-profile-v4')) || user;
      } catch { return user; }
    }
    function saveUser(u) {
      localStorage.setItem('abelion-profile-v4', JSON.stringify(u));
    }
    // UI Render
    function render() {
      user = loadUser();
      // Avatar
      document.getElementById('profile-avatar').src = user.photo || 'https://ui-avatars.com/api/?name='+encodeURIComponent(user.username||'User')+'&background=5ecbff&color=222&size=128';
      document.getElementById('profile-username').innerText = user.username||'User';
      // Greeting
      let hour = new Date().getHours();
      let greet = (hour<11)?"Selamat pagi":(hour<15)?"Selamat siang":(hour<19)?"Selamat sore":"Selamat malam";
      document.getElementById('profile-greeting').innerHTML = greet+', <b id="profile-username">'+(user.username||'User')+'</b> ðŸ‘‹';
      // Title
      let activeTitle = TITLES.find(t=>t.key===user.title) || TITLES[0];
      document.getElementById('xp-title-btn').innerText = activeTitle.icon+' '+activeTitle.name;
      document.getElementById('xp-level-btn').innerText = 'level '+(user.level||1);
      // XP bar
      let levelXP = getLevelXP(user.level||1);
      let xpPercent = Math.min(100, Math.round(100*(user.xp||0)/levelXP));
      document.getElementById('xp-bar-inner').style.width = xpPercent+'%';
      document.getElementById('xp-countdown').innerText = (levelXP-(user.xp||0))+' XP untuk naik level';
      // Badges
      let badgesHTML = TITLES.map(t=>{
        let unlocked = t.cond(user);
        let active = user.title===t.key;
        let cl = 'badge-box'+(unlocked?' badge-box--unlocked':'')+(active?' badge-box--active':'');
        return `<div class="${cl}" data-key="${t.key}" tabindex="0">
            ${unlocked?t.icon:'<svg width="28" height="28"><circle cx="14" cy="14" r="10" fill="#dde4ee"/></svg>'}
            <div class="badge-label">${t.icon} ${t.name}</div>
          </div>`;
      }).join('');
      document.getElementById('badges-row').innerHTML = badgesHTML;
      // Badge click
      document.querySelectorAll('.badge-box').forEach(box=>{
        box.onclick = function(){
          let key = this.getAttribute('data-key');
          if(TITLES.find(t=>t.key===key).cond(user)){
            user.title = key; saveUser(user); render();
            gsap.fromTo(this,{scale:1.07},{scale:1.19,duration:.18,yoyo:true,repeat:1});
          }
        }
      });
    }
    // Edit photo
    document.querySelector('.edit-photo-label').onclick = ()=>document.getElementById('profile-photo-input').click();
    document.getElementById('profile-photo-input').onchange = function(e){
      let file = e.target.files[0];
      if(!file) return;
      if(file.size>2*1024*1024) { alert("Ukuran foto maksimal 2MB!"); return; }
      let reader = new FileReader();
      reader.onload = function(ev){
        user.photo = ev.target.result; saveUser(user); render();
      }; reader.readAsDataURL(file);
    };
    // Ganti title
    document.getElementById('change-title-btn').onclick = function(){
      alert("Klik badge yang sudah terbuka untuk mengaktifkan title/rank kamu!");
    };
    // Dummy: Edit profile/settings
    window.editProfile = ()=>alert('Fitur edit profile segera hadir!');
    window.openSettings = ()=>alert('Settings coming soon!');
    // Animasi masuk
    window.onload = () => {
      gsap.from(".profile-card", {y:50, opacity:0, duration:.7, ease:"power3.out"});
      gsap.from(".profile-avatar", {scale:0.7, opacity:0, duration:.9, delay:.13, ease:"back.out(1.7)"});
      gsap.from(".profile-greeting", {x:40, opacity:0, duration:.7, delay:.3});
      gsap.from(".level-title-row", {y:18, opacity:0, duration:.5, delay:.42});
      gsap.from(".xp-bar", {width:0, opacity:0, duration:.7, delay:.5});
      gsap.from(".badge-panel", {y:38, opacity:0, duration:.8, delay:.53});
      gsap.from(".profile-btn-row", {x:-30, opacity:0, duration:.6, delay:.7});
    };
    // INIT
    render();
  </script>
</body>
</html>
