<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Profil - Abelion Notes</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    body { background: #f8faff; min-height: 100vh; }
    .profile-wrap {
      display: flex; align-items: center; justify-content: center; min-height: 100vh;
    }
    .profile-card {
      background: #fff;
      max-width: 430px;
      margin: 40px auto 0 auto;
      border-radius: 23px;
      box-shadow: 0 8px 38px #1e5cff14, 0 1.5px 8px #0001;
      padding: 32px 26px 28px 26px;
      text-align: center;
      width: 100%;
    }
    .profile-avatar {
      width: 94px; height: 94px;
      border-radius: 50%; object-fit: cover;
      border: 4px solid #1785ff33;
      margin-bottom: 18px;
      background: #f0f4ff;
      box-shadow: 0 2px 8px #e8f1ff;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .profile-title {
      font-size: 1.47em; font-weight: bold; color: #1785ff;
      margin-bottom: 3px;
    }
    .profile-welcome { color: #252f47; margin-bottom: 24px; }
    .profile-form-label { text-align:left; margin-bottom: 7px; font-weight:500;}
    .profile-input {
      width: 100%; max-width: 320px; font-size:1.08em;
      padding: 11px; border-radius: 9px; border: 1.5px solid #d0e6ff;
      margin-bottom: 21px; background: #f6faff; transition: border .15s;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .profile-input:focus { border-color: #1785ff;}
    .profile-upload-box {
      display: flex; flex-direction:column; align-items:center;
      border: 2px dashed #b1d2ff; border-radius: 12px;
      padding: 18px 10px 10px 10px; background: #f6faff; margin: 0 auto 17px auto;
      max-width: 250px;
    }
    .profile-upload-label {
      display:inline-block; color: #1785ff; font-weight: 600; margin-top: 5px;
      cursor: pointer; padding: 7px 18px; border-radius: 8px; background: #eaf4ff;
      transition: background .16s;
    }
    .profile-upload-label:hover { background: #d8ecff; }
    .profile-save-btn {
      background: #1785ff; color: #fff; font-weight:600; border: none;
      padding: 13px 0; width: 100%; max-width: 320px; border-radius: 10px;
      font-size: 1.12em; box-shadow: 0 2px 12px #1785ff22;
      margin-top: 10px; cursor: pointer; transition: background .15s;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .profile-save-btn:hover { background: #3b97ff;}
    .profile-caption {font-size:0.98em; color:#888;}
    @media (max-width: 520px){
      .profile-card {padding:18px 3vw 18px 3vw;}
      .profile-wrap {padding: 0;}
    }
  </style>
</head>
<body>
  <div class="profile-wrap">
    <div class="profile-card">
      <img src="default-avatar.png" alt="Foto Profil" class="profile-avatar" id="profile-avatar"/>
      <form id="profile-form" autocomplete="off">
        <div class="profile-title">Profil Peserta Tryout</div>
        <div class="profile-welcome" id="profile-welcome"></div>
        <div class="profile-section-title" style="font-size:1.09em;margin:15px 0 9px 0;font-weight:600;letter-spacing:0.04em;">
          <span style="border-bottom:2.5px solid #1785ff;">Pengaturan Akun</span>
        </div>
        <label class="profile-form-label" for="profile-name">Nama Lengkap:</label>
        <input type="text" id="profile-name" class="profile-input" required maxlength="40"/>

        <div class="profile-upload-box">
          <input type="file" accept="image/*" id="profile-photo-input" style="display:none"/>
          <label for="profile-photo-input" class="profile-upload-label">Ubah Foto Profil</label>
          <div class="profile-caption">Ukuran file maksimal 2MB. Format: JPG, PNG.</div>
        </div>
        <button type="submit" class="profile-save-btn">Simpan Perubahan Akun</button>
      </form>
    </div>
  </div>
  <script>
    // --- Load profile from localStorage ---
    const PROFILE_KEY = 'abelion-profile';
    function loadProfile() {
      try { return JSON.parse(localStorage.getItem(PROFILE_KEY)) || {}; } catch { return {}; }
    }
    function saveProfile(data) {
      localStorage.setItem(PROFILE_KEY, JSON.stringify(data));
    }
    function showProfile() {
      const profile = loadProfile();
      document.getElementById('profile-name').value = profile.name || '';
      document.getElementById('profile-avatar').src = profile.photo || 'default-avatar.png';
      document.getElementById('profile-welcome').innerHTML = profile.name ? `Selamat datang, <b>${profile.name}</b>!` : "Silakan lengkapi profil Anda";
    }
    showProfile();

    // --- Handle foto profil upload ---
    document.getElementById('profile-photo-input').addEventListener('change', function(e){
      const file = e.target.files[0];
      if(!file) return;
      if(file.size > 2*1024*1024) { alert("Ukuran foto maksimal 2MB!"); return; }
      const reader = new FileReader();
      reader.onload = function(ev){
        document.getElementById('profile-avatar').src = ev.target.result;
        let profile = loadProfile();
        profile.photo = ev.target.result;
        saveProfile(profile);
      };
      reader.readAsDataURL(file);
    });

    // --- Simpan perubahan nama ---
    document.getElementById('profile-form').onsubmit = function(e){
      e.preventDefault();
      let name = document.getElementById('profile-name').value.trim();
      let avatar = document.getElementById('profile-avatar').src;
      let profile = loadProfile();
      profile.name = name;
      profile.photo = avatar;
      saveProfile(profile);
      alert("Profil disimpan!");
      showProfile();
    };
  </script>
</body>
</html>
